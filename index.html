<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>💖 Our 1st Anniversary</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Poppins:wght@300;400;600&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            display: flex; /* Make body a flex container */
            justify-content: center; /* Center content horizontally */
            align-items: center; /* Center content vertically */
            flex-direction: column; /* Stack content vertically */
        }
        
        .hearts {
            position: fixed;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .heart {
            position: absolute;
            color: rgba(255, 192, 203, 0.8);
            font-size: 20px;
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); opacity: 0; }
            50% { transform: translateY(-100px) rotate(180deg); opacity: 1; }
        }
        
        .container {
            position: relative;
            z-index: 10;
            text-align: center;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            width: 100%; /* Ensure container takes full width */
            max-width: 900px; /* Optional: limit max width for better readability */
        }

        /* Styles for the initial landing page */
        #landingPage {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            min-height: 100vh; /* Make it full height */
            width: 100%;
            color: white;
            padding: 20px;
        }

        #landingPage h1 {
            font-family: 'Dancing Script', cursive;
            font-size: 4rem;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: glow 2s ease-in-out infinite alternate;
        }

        #landingPage p {
            font-size: 1.5rem;
            margin-bottom: 40px;
            font-weight: 300;
        }

        .love-button {
            background: linear-gradient(45deg, #ff6b6b, #ee5a6f);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 30px;
            font-family: 'Dancing Script', cursive;
            font-size: 2.2rem;
            cursor: pointer;
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            letter-spacing: 1px;
            margin-top: 30px; /* Add margin to separate from countdown */
        }

        .love-button:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 12px 25px rgba(0,0,0,0.4);
        }
        
        .main-title {
            font-family: 'Dancing Script', cursive;
            font-size: 4rem;
            color: white;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: glow 2s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from { text-shadow: 2px 2px 4px rgba(0,0,0,0.3), 0 0 20px rgba(255,255,255,0.5); }
            to { text-shadow: 2px 2px 4px rgba(0,0,0,0.3), 0 0 30px rgba(255,255,255,0.8); }
        }
        
        .subtitle {
            font-size: 1.5rem;
            color: rgba(255,255,255,0.9);
            margin-bottom: 30px;
            font-weight: 300;
        }
        
        .countdown-container {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            margin: 30px 0;
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            width: fit-content; /* Make it fit content on landing page */
            max-width: 90%; /* Limit width on smaller screens */
        }
        
        .countdown {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }
        
        .time-unit {
            background: rgba(255,255,255,0.2);
            border-radius: 15px;
            padding: 20px;
            min-width: 100px;
            backdrop-filter: blur(5px);
        }
        
        .time-number {
            font-size: 3rem;
            font-weight: 600;
            color: white;
            display: block;
        }
        
        .time-label {
            font-size: 0.9rem;
            color: rgba(255,255,255,0.8);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .gifts-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
            max-width: 800px;
            width: 100%;
        }
        
        .gift-box {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255,255,255,0.2);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .gift-box:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            background: rgba(255,255,255,0.2);
        }
        
        .gift-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            animation: bounce 2s infinite;
        }
        
        .gift-title {
            font-family: 'Dancing Script', cursive;
            font-size: 1.8rem;
            color: white;
            margin-bottom: 10px;
        }
        
        .gift-preview {
            color: rgba(255,255,255,0.8);
            font-size: 0.9rem;
        }
        
        .gift-content {
            display: none;
            background: rgba(255,255,255,0.95);
            color: #333;
            border-radius: 15px;
            padding: 20px;
            margin-top: 15px;
            text-align: left;
            line-height: 1.6;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .gift-content.active {
            display: block;
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-15px); }
            60% { transform: translateY(-8px); }
        }
        
        .special-message {
            background: linear-gradient(45deg, #ff6b6b, #ee5a6f);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            color: white;
            box-shadow: 0 10px 30px rgba(238, 90, 111, 0.3);
            max-width: 600px;
        }
        
        .unlock-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-top: 10px;
        }
        
        .unlock-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .opened {
            background: rgba(76, 175, 80, 0.2) !important;
            border-color: rgba(76, 175, 80, 0.5) !important;
        }
        .voice-controls {
            display: flex; gap: 10px; justify-content: center; margin: 15px 0;
        }
        .record-btn, .play-btn, .stop-btn, .upload-btn { 
            background: linear-gradient(45deg, #e74c3c, #c0392b); 
            color: white; border: none; padding: 8px 15px; 
            border-radius: 20px; cursor: pointer;
            font-size: 0.9rem; 
        }
        .record-btn.recording { 
            background: linear-gradient(45deg, #27ae60, #2ecc71); 
        }
        .audio-player { display: none; margin: 10px 0; }
        .audio-player.active { display: block; }
        .names {
            font-family: 'Dancing Script', cursive;
            font-size: 2rem;
            color: rgba(255,255,255,0.9);
            margin: 20px 0;
        }
        
        @media (max-width: 768px) {
            .main-title { font-size: 2.5rem; }
            .countdown { gap: 15px; }
            .time-unit { min-width: 80px; padding: 15px; }
            .time-number { font-size: 2rem; }
            .gifts-section { 
                grid-template-columns: 1fr;
                margin: 20px 10px; 
            }
            .gift-box { padding: 20px; }

            #landingPage h1 {
                font-size: 3rem;
            }
            #landingPage p {
                font-size: 1.2rem;
            }
            .love-button {
                font-size: 1.8rem;
                padding: 12px 30px;
            }
        }
    </style>
</head>
<body>
    <div class="hearts" id="hearts"></div>
    
    <div id="landingPage">
        <h1>Welcome, My Love!</h1>
        <p>A special surprise awaits you...</p>

        <div class="countdown-container">
            <h2 style="color: white; margin-bottom: 20px; font-family: 'Dancing Script', cursive; font-size: 2rem;">Time Until Our Special Day!</h2>
            <div class="countdown" id="countdown">
                <div class="time-unit">
                    <span class="time-number" id="days">00</span>
                    <span class="time-label">Days</span>
                </div>
                <div class="time-unit">
                    <span class="time-number" id="hours">00</span>
                    <span class="time-label">Hours</span>
                </div>
                <div class="time-unit">
                    <span class="time-number" id="minutes">00</span>
                    <span class="time-label">Minutes</span>
                </div>
                <div class="time-unit">
                    <span class="time-number" id="seconds">00</span>
                    <span class="time-label">Seconds</span>
                </div>
            </div>
        </div>

        <button class="love-button" onclick="showMainContent()">💖 I Love You 💖</button>
    </div>

    <div class="container" id="mainContent" style="display: none;">
        <h1 class="main-title">💖 Our Love Story 💖</h1>
        <p class="subtitle">Celebrating 1 Year of Pure Magic</p>
        
        <h2 style="color: white; font-family: 'Dancing Script', cursive; font-size: 2.5rem; margin: 30px 0 20px 0;">🎁 Your Anniversary Gifts 🎁</h2>
        <p style="color: rgba(255,255,255,0.8); margin-bottom: 30px;">Click on each gift to unlock your surprise, meri jaan! 💕</p>
        
        <div class="gifts-section">
            <div class="gift-box" onclick="openGift(1, this)">
                <div class="gift-icon">💌</div>
                <div class="gift-title">Love Letter</div>
                <div class="gift-preview">A heartfelt message from my soul to yours...</div>
                <button class="unlock-btn">Unlock Gift 💖</button>
                <div class="gift-content" id="gift1">
                    <h3 style="color: #ee5a6f; font-family: 'Dancing Script', cursive; font-size: 1.5rem; margin-bottom: 15px;">To My Milli Billi Meow Sinha 🐱</h3>
                    <p><strong>1 saal pehle tak soche bhi nhi थे ki kisi ki sirf awaaz… dil ko itna sukoon de sakti hai.</strong></p>
                    <br>
                    <p>Woh pehla call jis din tmhra birthday tha usi din hum tmko sune थे... woh call pe thda der ka baat se humko lga tha ki kch toh alag hai tum me ✨</p>
                    <br>
                    <p>Tumse milne ka koi chance nahi bacha tha… par shayad taqdeer thi bhgwn ji likhe थे hmlg ka milna. 🌟</p>
                    <br>
                    <p><em>Tu sirf meri wyf, lyf partner nahi — meri aadat, meri zarurat, mera sukoon ban gayi hai. 💕</em></p>
                    <br>
                    <p><strong>Promise hai mera tmse - tmhre saath uska har kadam chahe woh galt rhe ya sahi humesha rhnge! ❤️</strong></p>
                </div>
            </div>
            
            <div class="gift-box" onclick="openGift(2, this)">
                <div class="gift-icon">📸</div>
                <div class="gift-title">Memory Lane</div>
                <div class="gift-preview">Our beautiful journey in memories...</div>
                <button class="unlock-btn">Unlock Memories 📷</button>
                <div class="gift-content" id="gift2">
                    <h3 style="color: #ee5a6f; font-family: 'Dancing Script', cursive; font-size: 1.5rem; margin-bottom: 15px;">Our Special Moments 💫</h3>
                    <p><strong>🎂 25 August:</strong> Woh car ride, woh cake, woh khushi ka birthday - tumne mujhe pehla kiss diya tha left side gaal me 😘</p>
                    <br>
                    <p><strong>🖐️ 8 September:</strong> Jab tum mehndi mein mera naam likhi thi - woh sirf ek mehndi wala hath nahi thi… meri zindagi ka sabse khoobsurat hissa tha</p>
                    <br>
                    <p><strong>💋 31 December:</strong> Viharilal mein firse mile the, first time lip kiss hua tha, kitna saara acha memory banaye थे!</p>
                    <br>
                    <p><strong>🙏 2 February:</strong> Sarswati puja ka din - tu gussa mein bhaag gayi thi, kitni mehnat se manaya tha tumko!</p>
                    <br>
                    <p><em>Har moment special tha, har memory precious hai humare liye ✨</em></p>
                </div>
            </div>
            
            <div class="gift-box" onclick="openGift(3, this)">
                <div class="gift-icon">🎵</div>
                <div class="gift-title">Voice Message</div>
                <div class="gift-preview">Something special for your ears...</div>
                <button class="unlock-btn">Play Message 🎧</button>
                <div class="gift-content" id="gift3">
                    <h3 style="color: #ee5a6f; font-family: 'Dancing; Script', cursive; font-size: 1.5rem; margin-bottom: 15px;">Voice Message 🎵</h3>
                    
                    <div style="background: rgba(0,0,0,0.1); padding: 15px; border-radius: 10px; margin: 15px 0;">
                        <h4 style="color: #ee5a6f; margin-bottom: 10px;">🎵 Special Message for You:</h4>
                        <audio controls id="githubAudioPlayer" style="width: 100%;">
                            <source src="https://raw.githubusercontent.com/anubhavboyz/anneivarsary/main/voicerecord.mp3" type="audio/mp3">
                            Your browser does not support audio.
                        </audio>
                    </div>
                    
                    <div style="background: #f0f0f0; padding: 15px; border-radius: 10px; border-left: 4px solid #ee5a6f; margin-top: 15px;">
                        <h4>💡 Message Script Suggestion:</h4>
                        <p><em>"Hey meri jaan, milli billi meow sinha 😂"</em></p>
                        <p><em>"Pehle toh Happy 1st Anniversary baby! ❤️"</em></p>
                        <p><em>"Yaad hai pehla call? Usi din se tmhari awaaz mera addiction ban gayi thi... aur aaj 1 saal baad, abhi bhi tmhari awaaz sun ke dil mein butterflies aa jaate hain. 🦋"</em></p>
                        <p><em>"Promise karta hun tumse - aage ke saare years bhi aise hi celebrate karenge. I love you so much yaar ❤️"</em></p>
                    </div>

                    <p style="margin-top: 15px;"><strong>📱 Record your own message below!</strong></p>
                    <div class="voice-controls">
                        <button class="record-btn" id="recordBtn" onclick="toggleRecording()">
                            🎤 Start Recording  
                        </button>
                        <button class="play-btn" id="playRecordedBtn" onclick="playRecording()" style="display: none;">
                            ▶️ Play Recorded
                        </button>
                        <button class="stop-btn" id="stopRecordedBtn" onclick="stopPlayback()" style="display: none;">
                            ⏹️ Stop Playback
                        </button>
                    </div>
                    
                    <div class="recording-status" id="recordingStatus"></div>
                    <div class="audio-player" id="recordedAudioPlayer"></div>
                    
                    <input type="file" id="audioFile" accept="audio/*" onchange="handleAudioUpload(event)" style="display: none;">
                    <label for="audioFile" class="upload-btn" style="background: #3498db;">📁 Upload Audio</label>
                </div>
            </div>
            
            <div class="gift-box" onclick="openGift(4, this)">
                <div class="gift-icon">🌟</div>
                <div class="gift-title">Future Promises</div>
                <div class="gift-preview">Our forever journey starts here...</div>
                <button class="unlock-btn">See Our Future 💫</button>
                <div class="gift-content" id="gift4">
                    <h3 style="color: #ee5a6f; font-family: 'Dancing Script', cursive; font-size: 1.5rem; margin-bottom: 15px;">Forever & Always 💕</h3>
                    <p><strong>🤝 My Promise:</strong> Tmhre saath uska har kadam chahe woh galt rhe ya sahi humesha rhnge</p>
                    <br>
                    <p><strong>💪 My Commitment:</strong> Uske liye humesha stand krnge uske saath jindagi bhar rhnge</p>
                    <br>
                    <p><strong>❤️ My Love:</strong> Marna v hh toh uske saath hi humko - Always together!</p>
                    <br>
                    <p><strong>🎂 Every Year:</strong> Har anniversary aise hi celebrate karenge, naye surprises ke saath</p>
                    <br>
                    <p><strong>🥺 My Request:</strong> Kabhi chor ke nh jaana humko - adhure hh hum tmhre binna</p>
                    <br>
                    <p style="text-align: center; font-size: 1.2rem; color: #ee5a6f;"><em><strong>Humesha saath rhna mere haath kbhi nh chorne plzz 💖</strong></em></p>
                </div>
            </div>
        </div>
        
        <div class="special-message">
            <h3 style="font-family: 'Dancing Script', cursive; font-size: 2rem; margin-bottom: 15px;">
                Happy 1st Anniversary! 🎉
            </h3>
            <p style="font-size: 1.2rem; line-height: 1.6;">
                Aaj 1 saal ho gaya… ek saal jisme pyaar bhi tha, ladayi bhi… dooriyaan bhi thi, lekin wapas aane ka junoon bhi. 💖<br><br>
                
                Sach mein yaar, ek saal kab tmhre saath beet gya pata hi nhi chala! ⏰✨<br><br>
                
                <strong>Main tujhmein pura hoon! 💕</strong>
            </p>
        </div>
        
        <div class="names">
            Forever Together 💑<br>
            <span style="font-size: 1.5rem;">Since July 25, 2024</span>
        </div>
    </div>

    <script>
        // Function to show the main content and hide the landing page
        function showMainContent() {
            document.getElementById('landingPage').style.display = 'none';
            document.getElementById('mainContent').style.display = 'flex'; // Use flex to maintain centering
            // updateCountdown(); // No need to call here, it runs automatically on landing page
        }

        // Create floating hearts
        function createHeart() {
            const heart = document.createElement('div');
            heart.className = 'heart';
            heart.innerHTML = '💖';
            heart.style.left = Math.random() * 100 + '%';
            heart.style.animationDuration = (Math.random() * 3 + 3) + 's';
            heart.style.animationDelay = Math.random() * 2 + 's';
            document.getElementById('hearts').appendChild(heart);
            
            setTimeout(() => {
                heart.remove();
            }, 6000);
        }
        
        // Create hearts every 2 seconds
        setInterval(createHeart, 2000);
        
        // Countdown Timer
        let countdownInterval; // Declare interval variable
        function updateCountdown() {
            // Set anniversary date to July 25, 2025
            const anniversaryDate = new Date('2025-07-25T00:00:00').getTime();
            const now = new Date().getTime();
            const distance = anniversaryDate - now;
            
            const countdownElement = document.getElementById('countdown');
            const countdownContainerH2 = document.querySelector('.countdown-container h2');

            if (distance > 0) {
                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                
                document.getElementById('days').textContent = days.toString().padStart(2, '0');
                document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
                document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
                document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
            } else {
                // Anniversary reached!
                if (countdownContainerH2) countdownContainerH2.textContent = 'Happy 1st Anniversary! 🎉💖';
                if (countdownElement) countdownElement.innerHTML = '<div style="font-size: 2rem; color: white;">🎊 IT\'S OUR SPECIAL DAY! 🎊</div>';
                clearInterval(countdownInterval); // Stop the interval when countdown finishes
            }
        }
        
        // Update countdown every second (runs immediately on page load)
        countdownInterval = setInterval(updateCountdown, 1000); 
        
        // Gift opening function
        function openGift(giftNumber, element) {
            const giftContent = document.getElementById('gift' + giftNumber);
            const button = element.querySelector('.unlock-btn');
            
            if (!giftContent.classList.contains('active')) {
                giftContent.classList.add('active');
                element.classList.add('opened');
                button.textContent = 'Opened! 💖';
                button.style.background = 'linear-gradient(45deg, #4caf50, #45a049)';
                
                // If it's the voice message gift, ensure GitHub audio starts playing
                if (giftNumber === 3) {
                    const githubAudio = document.getElementById('githubAudioPlayer');
                    if (githubAudio) {
                        githubAudio.play();
                    }
                }

                // Create celebration effect
                createCelebration();
            }
        }
        
        // Celebration effect when gift is opened
        function createCelebration() {
            const colors = ['🎉', '🎊', '💖', '✨', '💕', '🌟'];
            for (let i = 0; i < 10; i++) {
                setTimeout(() => {
                    const emoji = colors[Math.floor(Math.random() * colors.length)];
                    const celebration = document.createElement('div');
                    celebration.textContent = emoji;
                    celebration.style.position = 'fixed';
                    celebration.style.left = Math.random() * 100 + '%';
                    celebration.style.top = '-50px';
                    celebration.style.fontSize = '2rem';
                    celebration.style.pointerEvents = 'none';
                    celebration.style.zIndex = '1000';
                    celebration.style.animation = 'float 3s ease-out forwards';
                    
                    document.body.appendChild(celebration);
                    
                    setTimeout(() => {
                        celebration.remove();
                    }, 3000);
                }, i * 100);
            }
        }
        
        // Click anywhere for hearts effect
        document.addEventListener('click', function(e) {
            if (e.target.closest('.gift-box') || e.target.closest('.love-button')) return; // Don't trigger on gift boxes or love button
            
            const colors = ['💖', '💕', '💝', '💗', '🌟', '✨'];
            const emoji = colors[Math.floor(Math.random() * colors.length)];
            
            const floatingEmoji = document.createElement('div');
            floatingEmoji.textContent = emoji;
            floatingEmoji.style.position = 'fixed';
            floatingEmoji.style.left = e.clientX + 'px';
            floatingEmoji.style.top = e.clientY + 'px';
            floatingEmoji.style.fontSize = '2rem';
            floatingEmoji.style.pointerEvents = 'none';
            floatingEmoji.style.zIndex = '1000';
            floatingEmoji.style.animation = 'float 2s ease-out forwards';
            
            document.body.appendChild(floatingEmoji);
            
            setTimeout(() => {
                floatingEmoji.remove();
            }, 2000);
        });

        // --- Voice Recording Logic ---
        let mediaRecorder;
        let audioChunks = [];
        let recordedAudioBlob; // To store the recorded audio blob
        let recordedAudioElement; // To store the audio element for playback
        let isRecording = false;

        const recordBtn = document.getElementById('recordBtn');
        const playRecordedBtn = document.getElementById('playRecordedBtn');
        const stopRecordedBtn = document.getElementById('stopRecordedBtn');
        const recordedAudioPlayerDiv = document.getElementById('recordedAudioPlayer');
        const recordingStatus = document.getElementById('recordingStatus');

        async function toggleRecording() {
            if (!isRecording) {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                    mediaRecorder = new MediaRecorder(stream);
                    audioChunks = [];
                    recordedAudioBlob = null; // Reset previous recording
                    recordedAudioPlayerDiv.innerHTML = ''; // Clear previous player
                    playRecordedBtn.style.display = 'none';
                    stopRecordedBtn.style.display = 'none';

                    mediaRecorder.ondataavailable = e => {
                        if (e.data.size > 0) {
                            audioChunks.push(e.data);
                        }
                    };

                    mediaRecorder.onstop = () => {
                        recordedAudioBlob = new Blob(audioChunks, { type: 'audio/webm' }); 
                        displayRecordedAudioPlayer(URL.createObjectURL(recordedAudioBlob));
                        recordingStatus.textContent = 'Recording finished!';
                        recordBtn.textContent = '🎤 Start Recording';
                        recordBtn.classList.remove('recording');
                        playRecordedBtn.style.display = 'inline-block';
                        stopRecordedBtn.style.display = 'none'; 
                    };

                    mediaRecorder.onstart = () => {
                        recordingStatus.textContent = 'Recording...';
                        recordBtn.textContent = '⏹️ Stop Recording';
                        recordBtn.classList.add('recording');
                    };

                    mediaRecorder.start();
                    isRecording = true;
                } catch (err) {
                    console.error('Error accessing microphone:', err);
                    recordingStatus.textContent = 'Error: Microphone access denied or unavailable.';
                }
            } else {
                if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                    mediaRecorder.stop();
                }
                isRecording = false;
            }
        }

        function displayRecordedAudioPlayer(url) {
            recordedAudioPlayerDiv.innerHTML = `<audio controls id="userRecordedAudio"><source src="${url}" type="audio/webm"></audio>`;
            recordedAudioElement = document.getElementById('userRecordedAudio');
            recordedAudioPlayerDiv.classList.add('active');

            recordedAudioElement.onplay = () => {
                playRecordedBtn.style.display = 'none';
                stopRecordedBtn.style.display = 'inline-block';
            };
            recordedAudioElement.onpause = recordedAudioElement.onended = () => {
                playRecordedBtn.style.display = 'inline-block';
                stopRecordedBtn.style.display = 'none';
            };
        }

        function playRecording() {
            if (recordedAudioElement) {
                recordedAudioElement.play();
            } else {
                recordingStatus.textContent = 'No recording found. Please record first.';
            }
        }

        function stopPlayback() {
            if (recordedAudioElement) {
                recordedAudioElement.pause();
                recordedAudioElement.currentTime = 0; 
            }
        }

        function handleAudioUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const url = URL.createObjectURL(file);
                displayRecordedAudioPlayer(url);
                recordingStatus.textContent = `Uploaded: ${file.name}`;
                recordBtn.style.display = 'none'; 
                playRecordedBtn.style.display = 'inline-block';
                stopRecordedBtn.style.display = 'none';
            }
        }
    </script>
</body>
</html>
